!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";function r(){return o}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.prototype.cookie=function(){return document.cookie},t.prototype.setCookie=function(t){document.cookie=t},t.prototype.body=function(){return document.body},t.prototype.referrer=function(){return document.referrer},t.prototype.title=function(){return document.title},t.prototype.createElement=function(t){return document.createElement(t)},t.prototype.dispatchEvent=function(t){return document.dispatchEvent(t)},t.prototype.querySelector=function(t){return document.querySelector(t)},t.prototype.querySelectorAll=function(t){return document.querySelectorAll(t)},t.prototype.documentElement=function(){return document.documentElement},t.prototype.getElementsByTagName=function(t){return document.getElementsByTagName(t)},t.prototype.createCustomEvent=function(t,e){try{return new CustomEvent(t,e)}catch(r){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}},t}(),o=new i;e.virtualDocument=r},function(t,e,n){"use strict";function r(){return m.virtualWindow().location().hash}function i(){return m.virtualWindow().location().host}function o(){return m.virtualWindow().location().hostname}function a(){return m.virtualWindow().location().href}function u(t){m.virtualWindow().location().href=t}function s(){var t=m.virtualWindow().location();return t.origin?t.origin:t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")}function c(){return m.virtualWindow().location().pathname}function p(){return m.virtualWindow().location().port}function f(){return m.virtualWindow().location().protocol}function l(){return m.virtualWindow().location().search}function d(t){return t=t||o(),null!==t.match(/(^|\.)shopify\.com$/)}Object.defineProperty(e,"__esModule",{value:!0});var m=n(2);e.hash=r,e.host=i,e.hostname=o,e.href=a,e.setHref=u,e.origin=s,e.pathname=c,e.port=p,e.protocol=f,e.search=l,e.isShopifyDotCom=d},function(t,e,n){"use strict";function r(){return o}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.nativeWindow=t}return t.prototype.location=function(){return this.nativeWindow.location},t.prototype.userAgent=function(){return this.nativeWindow.navigator.userAgent},t.prototype.crypto=function(){return this.nativeWindow.crypto||this.nativeWindow.msCrypto},t.prototype.top=function(){return this.nativeWindow.top?new t(this.nativeWindow.top):void 0},t.prototype.parent=function(){return this.nativeWindow.parent?new t(this.nativeWindow.parent):void 0},t.prototype.postMessage=function(t,e,n){this.nativeWindow.postMessage(t,e,n)},t.prototype.addEventListener=function(t,e,n){this.nativeWindow.addEventListener(t,e,n)},t.prototype.performance=function(){return this.nativeWindow.performance},t.prototype.supportsNavigationTiming=function(){return"PerformanceNavigationTiming"in this.nativeWindow},t.prototype.supportsPaintTiming=function(){return"PerformancePaintTiming"in this.nativeWindow},t}(),o=new i(window);e.virtualWindow=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(e,n){this.options={},this.options=t.merge(e,n)}return t.merge=function(t,e){var n={};for(var r in t)n[r]=t[r];for(var r in e)n[r]=e[r];return n},t.flatten=function(e){var n=t.merge(e,{});return n.properties={},t.merge(n,e.properties)},t.isEqual=function(t,e){for(var n in t)if(t[n]!==e[n])return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0},t}();e.Integration=r},function(t,e,n){"use strict";function r(t,n,r,i){return i=i||e.requestImpl.base(),"/"!==i[i.length-1]&&(i+="/"),e.requestImpl.img(i+t+"/"+n+"?"+e.requestImpl.queryString(r))}function i(t){u=t}function o(t,e){return r("internal_errors","page",{name:t.name,line:t.lineNumber||t.line,script:t.fileName||t.sourceURL||t.script,stack:t.stackTrace||t.stack||t.description,message:t.message,url:a.href(),context:void 0!==e?e:null,appConfig:u||null})}Object.defineProperty(e,"__esModule",{value:!0});var a=n(1);e.requestImpl={base:function(){return"https://v.shopify.com/"},img:function(t){var e=new Image(1,1);return e.src=t,e.style.display="none",e},queryString:function(t){var e=[];for(var n in t)("number"==typeof t[n]||t[n])&&("object"==typeof t[n]&&0===Object.keys(t[n]).length||e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n])));if(function(t){for(var e=t.length;e>0;--e){var n=Math.floor(Math.random()*e),r=t[n];t[n]=t[e-1],t[e-1]=r}}(e),e.length>1&&0===e[0].indexOf("event=")){var r=e[0];e[0]=e[1],e[1]=r}return e.join("&")}},e.load=r;var u=void 0;e.setGlobalSerializedAppConfig=i,e.internalError=o},function(t,e,n){"use strict";function r(){return e.cookieImpl.enabled()}function i(t){return e.cookieImpl.read(t)}function o(t,n,r){void 0===r&&(r={}),a(t,n,r.permanent,e.shopifyCookie.domain(s.hostname())),a(t,n,r.permanent,f),a(t,n,r.permanent,r.domain),a(t,n,r.permanent,"")}function a(t,n,r,i){var o={maxage:r?p:c,domain:i,path:"/"};e.cookieImpl.write(t,n,o)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(0),s=n(1),c=18e5,p=62208e6,f=".myshopify.com";e.cookieImpl={parse:function(t){for(var e={},n=0,r=t.split(/ *; */);n<r.length;n++){var i=r[n],o=i.split("=");try{e[decodeURIComponent(o[0])]=decodeURIComponent(o[1]||"")}catch(t){}}return e},read:function(t){if(e.cookieImpl.enabled())return e.cookieImpl.parse(u.virtualDocument().cookie())[t]},write:function(t,n,r){if(void 0===r&&(r={}),e.cookieImpl.enabled()){var i=encodeURIComponent(t)+"="+encodeURIComponent(n);r.maxage&&(r.expires=new Date(Date.now()+r.maxage)),r.path&&(i+="; path="+r.path),r.domain&&(i+="; domain="+r.domain),r.expires&&(i+="; expires="+r.expires.toUTCString()),r.secure&&(i+="; secure"),u.virtualDocument().setCookie(i)}},enabled:function(){try{if(void 0===u.virtualDocument().cookie())return!1;u.virtualDocument().setCookie("cookietest=1");var t=-1!==u.virtualDocument().cookie().indexOf("cookietest=");return u.virtualDocument().setCookie("cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT"),t}catch(t){return!1}}},e.enabled=r,e.read=i,e.write=o,e.shopifyCookie={domain:function(t){var e=t.indexOf("shopify");return 0===e?"."+t:e>0?t.slice(e-1):".shopify.com"}}},function(t,e,n){"use strict";function r(){return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.exportVar="analytics",e.shouldPerformXtldExchange=r,e.enabledIntegrations=[];var i=n(12);e.enabledIntegrations.push(["Performance",i.Performance]);var o=n(13);e.enabledIntegrations.push(["Clickstream",o.Clickstream]);var a=n(17);e.enabledIntegrations.push(["Session Attribution",a.SessionAttribution])},function(t,e,n){"use strict";function r(){return!!p.read(e.shortTermKey)||!!p.read(e.deprecatedShortTermKey)}function i(){return!!p.read(e.longTermKey)||!!p.read(e.deprecatedLongTermKey)}function o(){return m.fetchOrSet(!1,e.deprecatedShortTermKey,e.shortTermKey)[0]}function a(){return m.fetchOrSet(!0,e.deprecatedLongTermKey,e.longTermKey)}function u(){return m.build()}function s(){return h.fetchOrSet(e.firstSeenKey)}function c(){return m.hexTime()}Object.defineProperty(e,"__esModule",{value:!0});var p=n(5),f=n(2);e.deprecatedShortTermKey="_s",e.shortTermKey="_shopify_s",e.deprecatedLongTermKey="_y",e.longTermKey="_shopify_y",e.firstSeenKey="_shopify_fs";var l="00000000",d="xxxx-4xxx-xxxx-xxxxxxxxxxxx",m={fetch:function(t){return p.read(t)},fetchOrSet:function(t,e,n){if(!p.enabled())return["00000000-0000-0000-4000-000000000000",!1];var r=m.fetch(n)||m.fetch(e),i=!1;r||(r=m.build(),i=!0);var o={permanent:t};return p.write(e,r,o),p.write(n,r,o),[r,i]},build:function(){var t="";try{var e=f.virtualWindow().crypto(),n=new Uint16Array(31);e.getRandomValues(n);var r=0;t=d.replace(/[x]/g,function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=n[r]%16,a="x"===t?o:3&o|8;return r++,a.toString(16)}).toUpperCase()}catch(e){t=d.replace(/[x]/g,function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=16*Math.random()|0;return("x"===t?r:3&r|8).toString(16)}).toUpperCase()}return m.hexTime()+"-"+t},hexTime:function(){var t=0,e=0;try{t=Date.now()>>>0}catch(e){t=(new Date).getTime()>>>0}try{e=performance.now()>>>0}catch(t){e=0}var n=Math.abs(t+e).toString(16).toLowerCase();return l.substr(0,8-n.length)+n}},h={fetch:function(t){return p.read(t)},fetchOrSet:function(t){var e=h.fetch(t)||(new Date).toJSON(),n={permanent:!0};return p.write(t,e,n),e}};e.hasShortTerm=r,e.hasLongTerm=i,e.shortTerm=o,e.longTerm=a,e.buildToken=u,e.firstSeen=s,e.hexTime=c},function(t,e,n){"use strict";function r(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0];t[o]===t.ready&&t[o].apply(t,i.slice(1))}for(var a=0,u=e;a<u.length;a++){var i=u[a],o=i[0];t[o]&&t[o]!==t.ready&&t[o].apply(t,i.slice(1))}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),o=n(6),a=n(4);e.replayAnalyticsQueue=r;try{var u=window[o.exportVar].config;if(u){a.setGlobalSerializedAppConfig(JSON.stringify(u));var s=window[o.exportVar],c=window.trekkie=new i.Tricorder(u,function(){window[o.exportVar]=c,window._visit={tag:function(){},multitrackToken:function(){return c.trekkie.defaultAttributes.uniqToken}},c.user=function(){return{traits:function(){return{uniqToken:c.trekkie.defaultAttributes.uniqToken}}}},r(c,s)})}}catch(t){a.internalError(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(10),o=n(6),a=n(4),u=n(0),s=n(1),c=/^https?:\/\//,p=function(){function t(t,e){var n=this;this.integrations=[],this.trekkie=new i.Trekkie(t.Trekkie,function(){setTimeout(function(){n.loadIntegrations(o.enabledIntegrations,t,n.trekkie,e)},0)}),this.integrations[0]!==this.trekkie&&this.integrations.unshift(this.trekkie)}return t.prototype.loadIntegrations=function(t,e,n,r){for(var i=this.waitFor(t.length,function(){try{r()}catch(t){a.internalError(t)}}),o=0,u=t;o<u.length;o++){var s=u[o];try{var c=e[s[0]];if(c&&"object"==typeof c){var p=s[1];this.integrations.push(new p(c,n,i))}else i()}catch(t){i(),a.internalError(t)}}},t.prototype.identify=function(t,e){void 0===t&&(t=""),void 0===e&&(e={});try{t instanceof Object&&(e=t,t="");for(var n=0,r=this.integrations;n<r.length;n++){r[n].identify({id:t,properties:e})}}catch(t){a.internalError(t)}},t.prototype.page=function(t,e){void 0===t&&(t=""),void 0===e&&(e={});try{t instanceof Object&&(e=t,t="");var n=this.pageDefaults();n.name=t,n.properties=r.Integration.merge(n.properties,e);for(var i=0,o=this.integrations;i<o.length;i++){o[i].page(n)}}catch(t){a.internalError(t)}},t.prototype.track=function(t,e){void 0===t&&(t=""),void 0===e&&(e={});try{t instanceof Object&&(e=t,t="");for(var n=0,r=this.integrations;n<r.length;n++){r[n].track({event:t,properties:e})}}catch(t){a.internalError(t)}},t.prototype.trackForm=function(t,e,n){var r=this;void 0===e&&(e=""),void 0===n&&(n={});try{t.addEventListener("submit",function(i){i.preventDefault(),r.track(e,n),setTimeout(function(){try{t.submit()}catch(t){a.internalError(t)}},0)})}catch(t){a.internalError(t)}},t.prototype.trackLink=function(t,e,n){var r=this;void 0===e&&(e=""),void 0===n&&(n={});try{t.addEventListener("click",function(i){var o=t.getAttribute("href")||t.getAttributeNS("http://www.w3.org/1999/xlink","href")||t.getAttribute("xlink:href");r.track(e,n),o&&"_blank"!==t.target&&!r.isMeta(i)&&(i.preventDefault(),setTimeout(function(){s.setHref(o)},0))})}catch(t){a.internalError(t)}},t.prototype.isMeta=function(t){if(t instanceof KeyboardEvent&&(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey))return!0;if(t instanceof MouseEvent){var e=t.which,n=t.button;if(!e&&void 0!==n)return 1===n||2===n;if(2===e)return!0}return!1},t.prototype.ready=function(t){try{t()}catch(t){a.internalError(t)}},t.prototype.waitFor=function(t,e){return 0===t?(setTimeout(e,0),function(){}):function(){0===--t&&setTimeout(e,0)}},t.prototype.pageDefaults=function(){var t=s.href(),e=t.indexOf("?");return t=-1===e?"":t.slice(e),e=t.indexOf("#"),t=-1===e?t:t.slice(0,e),t="?"===t?"":t,{referrer:u.virtualDocument().referrer(),path:s.pathname(),search:t,title:u.virtualDocument().title(),url:this.url(),properties:{}}},t.prototype.canonical=function(){for(var t=u.virtualDocument().getElementsByTagName("link"),e=0;e<t.length;e++){var n=t[e];if("canonical"===n.getAttribute("rel")){var r=n.getAttribute("href");if(!c.test(r))continue;if(r.replace(c,"").length<=5)continue;return r}}return""},t.prototype.url=function(){var t=this.canonical();if(t)return t.indexOf("?")>0?t:t+s.search();var e=s.href(),n=e.indexOf("#");return-1===n?e:e.slice(0,n)},t}();e.Tricorder=p},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=n(4),a=n(7),u=n(11),s=n(2),c=n(0),p=n(6),f=n(1),l=n(18),d=n(5),m=function(t){function e(e,n){var r=t.call(this,{},e)||this;return r.shouldPerformXtldExchange()?l.performXtldExchange(l.xtldImpl.frameSource(),function(t,i){t?(d.write(a.deprecatedLongTermKey,t,{permanent:!0}),d.write(a.longTermKey,t,{permanent:!0}),r.init(e,n)):o.internalError(i||"Cannot load xtld token")}):r.init(e,n),r}return r(e,t),e.prototype.shouldPerformXtldExchange=function(){return p.shouldPerformXtldExchange()&&!a.hasLongTerm()&&!f.isShopifyDotCom()},e.prototype.init=function(t,e){this.injectEmitFunc(t),this.initInstanceVars(t),"parent"===t.embedMode&&this.installFrameListener(),e()},e.prototype.injectEmitFunc=function(t){var e=t.development?"testing":t.appName;u.isBot()&&(e="bot-traffic"),this.emitEvent=function(n,r){t.endpointBase?o.load(e,n,r,t.endpointBase):o.load(e,n,r)}},e.prototype.initInstanceVars=function(t){var e="",n="",r="",o=!1;"iframe"!==t.embedMode&&(u=a.longTerm(),e=u[0],o=u[1],n=a.shortTerm(),r=a.firstSeen()),this.defaultAttributes={appName:t.appName,uniqToken:e,visitToken:n,microSessionId:a.buildToken(),microSessionCount:0,firstSeen:r},t.enableNewUserAttribute&&(this.defaultAttributes.newUser=o),t.defaultAttributes&&(this.defaultAttributes=i.Integration.merge(t.defaultAttributes,this.defaultAttributes));var u},e.prototype.identify=function(t){this.emit("identify",t)},e.prototype.page=function(t){e.isEqualPage(this.lastPage,t)||(this.lastPage=t,this.emit("page",t))},e.prototype.track=function(t){this.emit("track",t)},e.prototype.emit=function(t,e,n){void 0===n&&(n={});var r=this.options;n.microSessionCount||++this.defaultAttributes.microSessionCount,e=i.Integration.flatten(e);var a=i.Integration.merge(e,this.defaultAttributes);if(a.eventType=t,a=i.Integration.merge(a,n),"iframe"===r.embedMode&&r.embedParentOrigin)try{this.getEmbedParent().postMessage(JSON.stringify({event:"trekkie:emit:v1",payload:{requestType:t,args:a,overrideAttributes:{microSessionId:a.microSessionId,microSessionCount:a.microSessionCount}}}),r.embedParentOrigin)}catch(t){o.internalError(t)}else this.emitEvent(t,a)},e.prototype.installFrameListener=function(){var t=this;s.virtualWindow().addEventListener("message",function(e){t.handleEmbedEvent(e)})},e.prototype.handleEmbedEvent=function(t){function e(t){return null!==t.match(/(shopify.com|shopifyapps.com|myshopify.io|shopifycloud.com|oberlo.com)$/)}function n(t){try{return window.Shopify&&window.Shopify.EmbeddedApp&&window.Shopify.EmbeddedApp.instance()&&window.Shopify.EmbeddedApp.instance().origin===t}catch(t){return!1}}try{if(!t||!t.data)return;if(!e(t.origin)&&!n(t.origin))return;var r=JSON.parse(t.data);if(!r.event||!r.event.match(/^trekkie:/))return;if(!e(t.origin)&&n(t.origin)&&"trekkie:emit:v1"!==r.event)return;switch(r.event){case"trekkie:emit:v1":var i=r.payload;i&&i.requestType&&i.args&&this.emit(i.requestType,i.args,i.overrideAttributes);break;case"trekkie:customEvent:v1":var i=r.payload;i&&i.eventType&&c.virtualDocument().dispatchEvent(c.virtualDocument().createCustomEvent(i.eventType,i.data));break;case"trekkie:xtldToken:v1":case"trekkie:xtldLastShop:v1":break;default:!function(t,e){o.internalError(new Error,JSON.stringify(e))}(r.event,r)}}catch(e){"SyntaxError"!==e.name&&o.internalError(e,JSON.stringify(t))}},e.prototype.getEmbedParent=function(){return s.virtualWindow().top()||s.virtualWindow().parent()},e.isEqualPage=function(t,e){return t&&e&&t.path===e.path&&t.referrer===e.referrer&&t.search===e.search&&t.title===e.title&&t.url===e.url&&t.name===e.name&&i.Integration.isEqual(t.properties,e.properties)},e}(i.Integration);e.Trekkie=m},function(t,e,n){"use strict";function r(){for(var t=0,e=o;t<e.length;t++){if(e[t].test(i.virtualWindow().userAgent()))return!0}return!1}Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=[/googlebot/i,/AdsBot-Google/i,/APIs-Google/i,/Mediapartners-Google/i,/developers.google.com/i,/bingbot/i,/Slurp/i,/duckduckbot/i,/Baiduspider/i,/YandexBot/i,/Sogou/i,/Sogou.*spider/i,/Exabot/i,/facebot/i,/facebookexternalhit/i,/ia_archiver/i];e.isBot=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=n(2),a=function(t){function e(n,r,i){var o=t.call(this,e.defaultOptions,n)||this;return o.trekkie=r,i(),o}return r(e,t),e.prototype.identify=function(t){},e.prototype.page=function(t){var e={event:"navigation_performance_metrics",properties:i.Integration.flatten(t)},n=this.options;n.navigationTimingApiMeasurementsEnabled&&n.navigationTimingApiMeasurementsSampleRate>=Math.random()&&(e.properties=i.Integration.merge(this.pagePerformance(),e.properties),this.trekkie.track(e))},e.prototype.track=function(t){},e.prototype.pagePerformance=function(){return(new u).collect()},e.defaultOptions={navigationTimingApiMeasurementsEnabled:!0,navigationTimingApiMeasurementsSampleRate:.001},e}(i.Integration);e.Performance=a;var u=function(){function t(){}return t.prototype.timing=function(){return!(!o.virtualWindow().performance()||!o.virtualWindow().performance().timing)&&o.virtualWindow().performance().timing},t.prototype.getEntry=function(t,e){var n=o.virtualWindow().performance().getEntriesByType(t);return e?n.find(function(t){return t.name===e}):n[0]},t.prototype.collect=function(){var e={},n=function(){for(var n=0,r=t.perfAttrs;n<r.length;n++){var i=r[n];e["nt:"+i]=0}e["nt:source"]="None",e["nt:valid"]=!1};if(o.virtualWindow().supportsNavigationTiming()&&!s())try{if(o.virtualWindow().supportsPaintTiming()){for(var r=0,i=t.paintAttrs;r<i.length;r++){var a=i[r],u=this.getEntry("paint",this.toEntryName(a));u&&(e["pt:"+a]=u.startTime)}e["pt:source"]="PerformancePaintTiming",e["pt:valid"]=!0}for(var c=this.getEntry("navigation"),p=0,f=t.navigationAttrs;p<f.length;p++){var a=f[p];a in c&&(e["nt:"+a]=c[a])}e["nt:timeOrigin"]=o.virtualWindow().performance().timeOrigin,e["nt:source"]="PerformanceNavigationTiming",e["nt:valid"]=!0}catch(t){n()}else if(this.timing()&&!s())try{for(var l=this.timing(),d=0,m=t.timingAttrs;d<m.length;d++){var a=m[d];e["nt:"+a]=l[a]}e["nt:source"]="PerformanceTiming",e["nt:valid"]=!0}catch(t){n()}else n();return e},t.prototype.toEntryName=function(e){return e.replace(t.upperCaseRegex,function(t){return"-"+t[0].toLowerCase()})},t.upperCaseRegex=/([A-Z])/g,t.perfAttrs=["connectEnd","connectStart","domComplete","domContentLoadedEventEnd","domContentLoadedEventStart","domInteractive","domainLookupEnd","domainLookupStart","fetchStart","loadEventEnd","loadEventStart","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","secureConnectionStart","unloadEventEnd","unloadEventStart"],t.timingAttrs=t.perfAttrs.concat(["domLoading","navigationStart"]),t.navigationAttrs=t.perfAttrs.concat(["decodedBodySize","encodedBodySize","redirectCount"]),t.paintAttrs=["firstPaint","firstContentfulPaint"],t}();e.PagePerformance=u;var s=function(){return new RegExp("MSIE 9.0|Firefox/7.0|Firefox/8.0").test(o.virtualWindow().userAgent())}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=n(14),a=n(16),u=n(4),s=n(0),c=n(1),p=function(t){function e(e,n,r){var i=t.call(this,{},e)||this;i.requestType="clickstream",i.config={storageKey:"_trekkie_cs",eventName:"click",customEventName:"trekkie-clickstream",validTargets:["a","button","input","select","textarea"],validInputSubTypes:["submit","file","radio","checkbox","text","email","search","tel","url","password","number","range","button","reset"],safeInputSubTypes:["submit","radio","checkbox","button","reset"],appName:null,flushInterval:5,instantFlush:!1},i.trekkie=n,i.config.appName=n.options.appName;var o=e.flushInterval;void 0!==o&&"number"==typeof o&&(i.config.flushInterval=o);var a=e.instantFlush;return void 0!==a&&"boolean"==typeof a&&(i.config.instantFlush=a),"iframe"===n.options.embedMode?i.clickQueue=i.createPostingQueue():i.config.instantFlush?i.clickQueue=i.createInstantQueue():i.clickQueue=i.createPersistedQueue(),i.flushClickEvents(),i.setClickListener(),i.setFlushInterval(),r(),i}return r(e,t),e.prototype.identify=function(t){},e.prototype.page=function(t){this.flushClickEvents()},e.prototype.track=function(t){var e=this;t.event===this.config.eventName&&setTimeout(function(){e.trekkie.emit(e.requestType,t)},0)},e.prototype.createPostingQueue=function(){return new a.PostingQueue(this.trekkie,this.requestType,this.config.eventName)},e.prototype.createPersistedQueue=function(){return new o.PersistedQueue(this.config.storageKey)},e.prototype.createInstantQueue=function(){var t=this;return new(function(){function e(){}return e.prototype.push=function(e){t.track({event:t.config.eventName,properties:e})},e.prototype.all=function(){return[]},e.prototype.clear=function(){},e}())},e.prototype.setFlushInterval=function(){var t=this;this.config.flushInterval>0&&setInterval(function(){t.flushClickEvents()},1e3*this.config.flushInterval)},e.prototype.flushClickEvents=function(){for(var t=0,e=this.clickQueue.all();t<e.length;t++){var n=e[t];this.track({event:this.config.eventName,properties:n})}this.clickQueue.clear()},e.prototype.setClickListener=function(){var t=this;s.virtualDocument().documentElement().addEventListener("click",function(e){t.trackClick(e)},!0)},e.prototype.trackClick=function(t){try{var e=this.preparePayload(this.resolveRawClickEvent(t));if(!e)return;this.clickQueue.push(e);try{var n=this.trekkie.options,r={detail:e};"iframe"===n.embedMode&&n.embedParentOrigin?this.trekkie.getEmbedParent().postMessage(JSON.stringify({event:"trekkie:customEvent:v1",payload:{eventType:this.config.customEventName,data:r}}),n.embedParentOrigin):s.virtualDocument().dispatchEvent(new CustomEvent(this.config.customEventName,r))}catch(t){}}catch(t){u.internalError(t)}},e.prototype.preparePayload=function(t){if(!t.resolved)return null;var e=t.clicked;return{app_name:this.config.appName,url:c.href(),target_text:this.getTextLabelFromHTMLElement(e),target_tagname:e.tagName,target_classname:this.getClassName(e),target_id:e.id,target_trekkie_context:t.data&&Object.getOwnPropertyNames(t.data).length>0?JSON.stringify(t.data):null,target_url:e.getAttribute("href"),target_form_input_type:this.isHTMLFormInputSubType(e)?e.type:null,target_form_action:this.isHTMLFormInputSubType(e)?this.getHTMLFormAction(e):null,target_form_relative_position:this.isHTMLFormInputSubType(e)?this.getFormRelativePosition(e):null}},e.prototype.resolveRawClickEvent=function(t){for(var e=t.target,n={clicked:e,resolved:void 0,data:{}};e;){!n.resolved&&this.shouldTrack(e)&&(n.resolved=e);for(var r=0,i=Array.prototype.slice.call(e.attributes);r<i.length;r++){var o=i[r];o&&o.value&&!n.data[o.name]&&o.name.match(/^data-trekkie-.*/)&&(n.data[o.name]=o.value)}e=this.parentElement(e)}return n},e.prototype.parentElement=function(t){var e=t.parentNode;return e.parentNode?e:void 0},e.prototype.shouldTrack=function(t){var e=t.tagName?t.tagName.toLowerCase():"";if("input"===e)return this.config.validInputSubTypes.indexOf(t.type.toLowerCase())>=0;for(var n=0;n<t.attributes.length;n++){var r=t.attributes.item(n);if("data-trekkie-id"===r.name&&r.value)return!0}return this.config.validTargets.indexOf(e)>=0},e.prototype.getClassName=function(t){return"object"==typeof t.className?t.parentElement.getAttribute("class"):t.className},e.prototype.getTextLabelFromHTMLElement=function(t){switch(t.tagName.toLowerCase()){case"input":return this.config.safeInputSubTypes.indexOf(t.type)>-1?t.value:t.name;case"select":var e=t.options.selectedIndex;return e>-1?t.options[e].text:"No value chosen";case"textarea":return t.name||"";default:return this.getTargetText(t)||this.getTextLabelFromParentHTMLElement(t)}},e.prototype.getTextLabelFromParentHTMLElement=function(t){for(;t.parentNode;)if(t=t.parentNode,t.tagName&&-1!==this.config.validTargets.indexOf(t.tagName.toLowerCase()))return this.getTargetText(t)},e.prototype.getTargetText=function(t){var e=t.innerText||t.textContent;if(e)return this.dedupTargetText(e.replace(/\s+/g," ").trim())},e.prototype.dedupTargetText=function(t){if(-1===t.indexOf(" "))return t;var e={};return t.split(" ").filter(function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)}).join(" ")},e.prototype.getHTMLFormAction=function(t){for(;t.parentNode;)if((t=t.parentNode)&&t.tagName&&"form"===t.tagName.toLowerCase()){var e=t.attributes.getNamedItem("action");if(e&&e.value)return e.value}return""},e.prototype.isHTMLFormInputSubType=function(t){return-1!==["input","select","textarea"].indexOf(t.tagName.toLowerCase())},e.prototype.getFormRelativePosition=function(t){switch(t.tagName.toLowerCase()){case"select":return t.options.selectedIndex;default:return null}},e}(i.Integration);e.Clickstream=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),i=function(){function t(t){this.queue=[],this.storage=new r.LocalStorage(t);var e=this.storage.get();null!==e&&(this.queue=JSON.parse(e))}return t.prototype.push=function(t){this.queue.push(t),this.persist()},t.prototype.all=function(){return this.queue},t.prototype.clear=function(){this.queue=[],this.persist()},t.prototype.persist=function(){this.storage.set(JSON.stringify(this.queue))},t}();e.PersistedQueue=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.storageName=t,this.storage=localStorage,this.storageEnabled=this.checkLocalStorageAvailability()}return t.prototype.get=function(){return this.storageEnabled?this.storage.getItem(this.storageName):null},t.prototype.set=function(t){this.storageEnabled&&this.storage.setItem(this.storageName,t)},t.prototype.checkLocalStorageAvailability=function(){try{return this.storage.setItem("test","ok"),this.storage.removeItem("test"),!0}catch(t){return(22===t.code||1014===t.code)&&(this.storage.clear(),!0)}},t}();e.LocalStorage=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this.trekkie=t,this.requestType=e,this.eventName=n}return t.prototype.push=function(t){this.trekkie.emit(this.requestType,{event:this.eventName,properties:t})},t.prototype.all=function(){return[]},t.prototype.clear=function(){},t}();e.PostingQueue=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),o=n(7),a=n(3),u=n(1),s=n(0);e.sessionAttributionEventKey="session-attribution",e.sessionAttributionParamsKey="_shopify_sa_p",e.sessionAttributionTimestampKey="_shopify_sa_t";var c=function(t){function n(e,n,r){var i=t.call(this,{},e)||this;return i.trekkie=n,i.timestampManager=new p,i.campaignManager=new f,setTimeout(function(){i.attributeSession()},0),r(),i}return r(n,t),n.prototype.identify=function(t){},n.prototype.page=function(t){},n.prototype.track=function(t){var n=this;t.event===e.sessionAttributionEventKey&&setTimeout(function(){n.trekkie.emit(e.sessionAttributionEventKey,t)},0)},n.prototype.attributeSession=function(){var t=new Date,n=u.search(),r=this.campaignManager.constructCanonicalUtmString(n);if(this.timestampManager.isValid(t)&&this.campaignManager.isValid(r));else{var i="";try{i=t.toJSON()}catch(t){}this.track({event:e.sessionAttributionEventKey,properties:{sa_url:u.href(),sa_referrer:s.virtualDocument().referrer(),sa_utm_string:r,sa_token:o.buildToken(),over_30_minutes:!this.timestampManager.isWithin30MinuteCutOff(t),cross_utc_midnight:this.timestampManager.isWithin30MinuteCutOff(t)&&!this.timestampManager.isSameDayAs(t),new_campaign:!this.campaignManager.isValid(r),prev_campaign_params:this.campaignManager.fetch(),last_extended:this.timestampManager.fetch(),local_now:i}})}this.timestampManager.extend(t.toJSON()),this.campaignManager.extend(r)},n}(a.Integration);e.SessionAttribution=c;var p=function(){function t(){}return t.prototype.fetch=function(){return i.read(e.sessionAttributionTimestampKey)},t.prototype.extend=function(t){i.write(e.sessionAttributionTimestampKey,t,{permanent:!1})},t.prototype.isValid=function(t){return this.isWithin30MinuteCutOff(t)&&this.isSameDayAs(t)},t.prototype.isWithin30MinuteCutOff=function(t){return this.testStoredTimestamp(function(t,e){return e.getTime()-t.getTime()<=18e5},t)},t.prototype.isSameDayAs=function(t){return this.testStoredTimestamp(function(t,e){return t.getUTCDate()===e.getUTCDate()},t)},t.prototype.testStoredTimestamp=function(t,e){var n=this.fetch();if(!n)return!1;try{return t(new Date(n),e)}catch(t){return!1}},t}();e.TimestampManager=p;var f=function(){function t(){}return t.prototype.fetch=function(){return i.read(e.sessionAttributionParamsKey)},t.prototype.extend=function(t){""===t&&(t=this.fetch()||""),i.write(e.sessionAttributionParamsKey,t,{permanent:!1})},t.prototype.isValid=function(t){return""===t||this.fetch()===t},t.prototype.constructCanonicalUtmString=function(e){if(""===e||void 0===e||null===e||"?"===e)return"";e="?"===e[0]?e.slice(1):e;for(var n={},r=0,i=e.split("&");r<i.length;r++){var o=i[r],a=o.split("=");if(!(a.length<2)){var u=this.decodeReplacingPlus(a[0]),s=this.decodeReplacingPlus(a[1]);s&&u&&(n[u]=s)}}return t.acceptedQueryStringParams.filter(function(t){return n[t]}).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(n[t])}).join("&")},t.prototype.decodeReplacingPlus=function(t){return decodeURIComponent(t.replace(/\+/g," "))},t.acceptedQueryStringParams=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","ref","gclid"],t}();e.CampaignManager=f},function(t,e,n){"use strict";function r(t,n,r){void 0===r&&(r=3e4),r>0&&(n=e.xtldImpl.handlerWithTimeout(n,r));var o="xtld-"+Math.random().toString(16).substring(2),a=function(){try{var r=e.xtldImpl.findFrame(o,t);r?e.xtldImpl.requestToken(r,"getLongTermCookie",n):n(void 0,new Error("Failed to load iFrame"))}catch(t){n(void 0,t)}};i.iframe({src:t,onLoad:a,className:o})}Object.defineProperty(e,"__esModule",{value:!0});var i=n(19),o=n(0),a=n(2);e.performXtldExchange=r,e.xtldImpl={requestToken:function(t,e,n){a.virtualWindow().addEventListener("message",function(e){try{e&&0===t.src.indexOf(e.origin)&&n(e.data)}catch(e){n(void 0,e)}}),t.contentWindow.postMessage(e,t.src)},handlerWithTimeout:function(t,e){var n=setTimeout(function(){t(void 0,new Error("Timed out, after "+e/1e3+" second(s)"))},e);return function(e,r){clearTimeout(n),t(e,r)}},frameSource:function(){return"https://cdn.shopify.com/s/javascripts/tricorder/xtld-frame.html"},findFrame:function(t,e){return o.virtualDocument().querySelector("iframe."+t+'[src="'+e+'"]')}}},function(t,e,n){"use strict";function r(t){var e=a.virtualDocument().createElement("script");return e.src=t.src,e.async=!0,o(e,t),a.virtualDocument().body().appendChild(e),e}function i(t){var e=a.virtualDocument().createElement("iframe");return e.src=t.src,e.style.display="none",o(e,t),a.virtualDocument().body().appendChild(e),e}function o(t,e){if(e.onLoad&&t.addEventListener("load",e.onLoad,!1),e.className){if(/^\d/.test(e.className))throw new Error("Invalid className: "+e.className+" starts with a digit");t.className=e.className}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(0);e.script=r,e.iframe=i}]);